# MediaCrawler 虚拟环境使用指南

## 为什么使用虚拟环境？

使用Python虚拟环境可以：
- 避免依赖包版本冲突
- 隔离项目环境，不影响系统Python
- 确保项目依赖的一致性
- 避免`pkg_resources`等警告信息

## 创建和激活虚拟环境

### Windows系统

```bash
# 1. 创建虚拟环境
python -m venv venv

# 2. 激活虚拟环境
.\venv\Scripts\Activate.ps1

# 3. 安装依赖
pip install -r requirements.txt
```

### macOS/Linux系统

```bash
# 1. 创建虚拟环境
python -m venv venv

# 2. 激活虚拟环境
source venv/bin/activate

# 3. 安装依赖
pip install -r requirements.txt
```

## 使用虚拟环境运行爬虫

激活虚拟环境后，命令行前面会显示`(venv)`，表示当前在虚拟环境中：

```bash
# 查看帮助
python main.py --help

# 运行爬虫示例
python main.py --platform xhs --type search --keywords "测试关键词"

# 运行短信验证码接收服务
python recv_sms.py
```

## 退出虚拟环境

```bash
deactivate
```

## 常见问题

### 1. 激活脚本执行策略错误
如果遇到PowerShell执行策略错误，可以：
```bash
# 临时更改执行策略
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

### 2. 依赖安装失败
如果网络问题导致安装失败，可以：
```bash
# 使用国内镜像源
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/
```

### 3. 虚拟环境损坏
如果虚拟环境出现问题，可以重新创建：
```bash
# 删除旧的虚拟环境
Remove-Item -Recurse -Force venv

# 重新创建
python -m venv venv
```

## 项目结构

```
MediaCrawler/
├── venv/                    # 虚拟环境目录
├── main.py                  # 主程序
├── requirements.txt         # 依赖列表
├── config/                  # 配置文件
├── media_platform/          # 各平台爬虫
├── tools/                   # 工具函数
└── docs/                    # 文档
```

## 注意事项

1. **始终在虚拟环境中运行项目**
2. **不要将venv目录提交到版本控制**
3. **定期更新依赖包版本**
4. **备份重要的配置文件**

## 开发建议

- 使用虚拟环境进行开发
- 定期清理缓存：`python tools/cache_cleaner.py`
- 测试前确保所有依赖正确安装
- 保持项目依赖的版本一致性 